1. Pull total number of orders that were completed on 18th March 2023
Answer-
select count(*) 
from orders
where order_date = '2023-03-18' 

2. Pull total number of orders that were completed on 18th March 2023 with the first name ‘John’ and last name ‘Doe’
Answer- 
select count(*)
from orders
where order_date = '2023-03-18'
and customerid in (select customerid from customers
where first_name like 'john' and lastname like 'doe'); 

3. Pull total number of customers that purchased in January 2023 and the average amount spend per customer
Answer - 
select count(distinct customerID), avg(AvgPurchaseAmount)
from(
select customerID, sum(purchaseAmount) as AvgPurchaseAmount
from Purchases
where date between '2023-01-01' and '2023-01-31'
group by customerID
)

4. Pull the departments that generated less than $600 in 2022
Answer - 
select DepartmentName
from department D
join revenue R on D.DeptID = R.DeptID
where year(RevenueDate) = 2022
group by D.DepartmentName
having sum(R.revenueAmount) < 600


5. What is the most and least revenue we have generated by an order
Answer -
select MAX(OrderRevenue), MIN(OrderRevenue)
from Revenue
join Orders on Revenue.OrderID = Order.ID

6. What were the orders that were purchased in our most lucrative order
Answer - 
WITH LucrativeOrder AS (
SELECT OrderID
FROM Orders
ORDER BY OrderRevenue DESC
LIMIT 1
)
SELECT o.OrderID, o.ProductID, o.Quantity, o.Price
FROM OrderDetails o
JOIN LucrativeOrder m ON o.OrderID = m.OrderID; 







